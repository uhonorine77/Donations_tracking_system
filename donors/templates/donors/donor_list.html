{% extends 'layout.html' %}

{% block content %}
<h1>Donor List</h1>

<div>
    <div class="search-create-container" style="margin-bottom: 20px;">
        <a class="btn btn-primary" href="{% url 'create_donor' %}" style="padding: 10px 15px; background-color: #28a745; color: white; border: none; border-radius: 4px; text-decoration: none;">Add new</a>
    </div>
    
    <div class="table-responsive">
        <table id="donorTable" class="table" style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr>
                    <th style="border: 1px solid #dee2e6; padding: 10px;">Username</th>
                    <th style="border: 1px solid #dee2e6; padding: 10px;">Email</th>
                    <th style="border: 1px solid #dee2e6; padding: 10px;">Phone Number</th>
                    <th style="border: 1px solid #dee2e6; padding: 10px;">Total Donations</th>
                    <th style="border: 1px solid #dee2e6; padding: 10px;">Last Donation Date</th>
                    <th style="border: 1px solid #dee2e6; padding: 10px;">Preferred Donation Method</th>
                    <th style="border: 1px solid #dee2e6; padding: 10px;">Role</th>
                    <th style="border: 1px solid #dee2e6; padding: 10px;">Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for donor in donors %}
                <tr style="border-bottom: 1px solid #dee2e6;">
                    <td style="border: 1px solid #dee2e6; padding: 10px;">{{ donor.username }}</td>
                    <td style="border: 1px solid #dee2e6; padding: 10px;">{{ donor.email }}</td>
                    <td style="border: 1px solid #dee2e6; padding: 10px;">{{ donor.phone_number }}</td>
                    <td style="border: 1px solid #dee2e6; padding: 10px;">${{ donor.total_donations|floatformat:2 }}</td>
                    <td style="border: 1px solid #dee2e6; padding: 10px;">{{ donor.last_donation_date|date:"Y-m-d" }}</td>
                    <td style="border: 1px solid #dee2e6; padding: 10px;">{{ donor.preferred_donation_method }}</td>
                    <td style="border: 1px solid #dee2e6; padding: 10px;">{{ donor.role }}</td>
                    <td style="border: 1px solid #dee2e6; padding: 10px;">
                        <a
                            href="update/{{donor.pk}}"
                            class="btn btn-warning"
                            style="padding: 8px 12px; background-color: #ffc107b5; color: white; border: none; border-radius: 4px; text-decoration: none; margin-right: 5px; transition: background-color 0.3s;"
                            onmouseover="this.style.backgroundColor='#ffca2a';"
                            onmouseout="this.style.backgroundColor='#ffc107';"
                        >Edit</a>
                        <a
                            href="delete/{{donor.pk}}"
                            class="btn btn-danger"
                            style="padding: 8px 12px; background-color: #dc354686; color: white; border: none; border-radius: 4px; text-decoration: none; transition: background-color 0.3s;"
                            onmouseover="this.style.backgroundColor='#e03e3e';"
                            onmouseout="this.style.backgroundColor='#dc3545';"
                            onclick="return confirm('Are you sure you want to delete this donor?');"
                        >Delete</a>
                    </td>         
                </tr>
                {% empty %}
                <tr>
                    <td colspan="8">No donors available.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div id="pagination" class="pagination" style="margin-top: 20px;">
        <div class="step-links" style="text-align: center;">
            {% if donors.has_previous %}
                <button class="btn btn-primary" style="padding: 5px 10px;"><a href="?page=1" style="text-decoration: none; color: white;">&laquo; first</a></button>
                <button class="btn btn-primary" style="padding: 5px 10px;"><a href="?page={{ donors.previous_page_number }}" style="text-decoration: none; color: white;">previous</a></button>
            {% endif %}
    
            <span class="current" style="margin: 0 10px;">
                Page {{ donors.number }} of {{ donors.paginator.num_pages }}.
            </span>
    
            {% if donors.has_next %}
                <button class="btn btn-primary" style="padding: 5px 10px;"><a href="?page={{ donors.next_page_number }}" style="text-decoration: none; color: white;">next</a></button>
                <button class="btn btn-primary" style="padding: 5px 10px;"><a href="?page={{ donors.paginator.num_pages }}" style="text-decoration: none; color: white;">last &raquo;</a></button>
            {% endif %}
        </div>
    </div>
</div>

<style>
    @media (max-width: 768px) {
        .table-responsive {
            overflow-x: auto;
        }

        .table th, .table td {
            padding: 8px;
        }

        .search-create-container {
            flex-direction: column;
            align-items: flex-start;
        }

        .search-input {
            margin-bottom: 10px;
        }
    }
</style>

{% endblock %}
